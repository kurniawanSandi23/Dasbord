<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Assign Team Joint Domain</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome untuk ikon -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Animate.css untuk animasi profesional -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="dark-theme">
    <div class="header">
        <h1><i class="fas fa-users-cog"></i> Dashboard Assign Team Joint Domain</h1>
        <p>Analisis Employee, Laptop i5/i7, Domain Status, NW Lead, Lokasi (Wisma 2 & BSD)</p>
        <button id="theme-toggle" class="btn btn-secondary mt-2">Toggle Theme</button>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="upload-section">
                    <div class="text-center mb-4">
                        <i class="fas fa-file-excel fa-2x text-success mb-2 glow"></i>
                        <h3>Upload File Excel (Assign team Joint Domain)</h3>
                    </div>
                    <div class="text-center">
                        <input type="file" id="fileInput" class="form-control mb-3" accept=".xlsx, .xls" style="max-width: 300px; margin: 0 auto;" />
                        <button class="btn btn-primary" onclick="loadFile()">
                            <i class="fas fa-upload glow"></i> Upload dan Tampilkan Data
                        </button>
                    </div>
                    <div id="loading" class="loading">
                        <div class="spinner"></div>
                        <p>Memproses file Excel (Team List Sheet)...</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="stats" class="row stats-container" style="display: none;">
            <div class="col-lg-3 col-md-6">
                <div class="stat-card i5">
                    <i class="fas fa-laptop-code glow"></i>
                    <div>Total Laptop i5</div>
                    <div id="totalI5" class="stat-number">0</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card i7">
                    <i class="fas fa-laptop-code glow"></i>
                    <div>Total Laptop i7</div>
                    <div id="totalI7" class="stat-number">0</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card lokasi">
                    <i class="fas fa-truck glow"></i>
                    <div>Wisma 2 (On Going)</div>
                    <div id="wisma2Rendah" class="stat-number">0</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card lokasi">
                    <i class="fas fa-truck glow"></i>
                    <div>BSD (On Going)</div>
                    <div id="bsdRendah" class="stat-number">0</div>
                </div>
            </div>
        </div>

        <div id="error" class="alert alert-danger" style="display: none;"></div>

        <div class="divider"></div>

        <div id="searchSection" class="row slide-in-right" style="display: none;">
            <div class="col-12">
                <div class="search-section">
                    <h4><i class="fas fa-search glow"></i> Pencarian</h4>
                    <div class="input-group mb-3">
                        <input type="text" id="searchInput" class="form-control" placeholder="Cari Employee Name, WXID, i5/i7, Wisma 2/BSD, Domain Status..." onkeyup="performSearch()">
                        <span class="input-group-text search-icon">
                            <i class="fas fa-search glow"></i>
                        </span>
                    </div>
                    <div id="searchResults" class="no-results" style="display: none;">Tidak ada hasil pencarian.</div>
                </div>
            </div>
        </div>

        <div class="divider"></div>

        <div id="groupSection" class="row slide-in-left" style="display: none;">
            <div class="col-12">
                <div class="group-section">
                    <h4><i class="fas fa-layer-group glow"></i> Pengelompokan Data</h4>
                    <div class="group-select">
                        <label for="groupBy" class="form-label">Pilih untuk Grup:</label>
                        <select id="groupBy" class="form-select" onchange="groupData()">
                            <option value="">-- Pilih Kolom atau Merek --</option>
                            <option value="merek">Merek Laptop (i5/i7)</option>
                            <option value="19">NW Lead</option>
                            <option value="29">Lokasi Kerja (Wisma/BSD)</option>
                            <option value="49">Domain Status</option>
                        </select>
                    </div>
                    <div id="groupedData"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="group-section">
                    <h4><i class="fas fa-table glow"></i> Tabel Data Employee (Team List Sheet)</h4>
                    <div class="table-responsive">
                        <table id="dataTable" class="table table-striped table-hover" style="display: none;">
                            <thead>
                                <tr>
                                    <th>Employee Name</th>
                                    <th>WXID</th>
                                    <th>Laptop Requirement</th>
                                    <th>Domain Status</th>
                                    <th>NW Lead</th>
                                    <th>Lokasi Kerja</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody"></tbody>
                        </table>
                        <div id="noSearchResults" class="no-results" style="display: none;">Tidak ada hasil pencarian di tabel ini.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 PT Nexwave. All rights reserved.</p>
            <p>Kontak: <a href="mailto:info@nexwave.co.id">info@nexwave.co.id</a> | Telp: +62 813-1408-6685</p>
            <p>Follow us:
                <a href="https://www.linkedin.com/company/pt-nexwave" target="_blank" class="social-icon"><i class="fab fa-linkedin"></i></a>
                <a href="https://twitter.com/PTNexwave" target="_blank" class="social-icon"><i class="fab fa-twitter"></i></a>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="script.js"></script>
    <!-- Library SheetJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        document.getElementById('theme-toggle').addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            document.body.classList.toggle('light-theme');
        });
    </script>
</body>
</html>